# 命理分析提示词配置说明

## 配置文件说明

命理分析功能使用JSON文件来管理模型参数和提示词，便于您自定义和调整。

### 文件位置

- **主配置文件**: `destiny_clock/mingli_prompts.json`
- **简化配置文件**: `destiny_clock/mingli_config.json`（备用）

### 配置结构

#### 1. 模型参数 (model)
```json
{
  "model": {
    "name": "gemini-2.5-pro",      // AI模型名称
    "temperature": 1.15,            // 创造性参数（0-2，越高越有创造性）
    "thinking_budget": -1           // 思考预算（-1为无限制）
  }
}
```

#### 2. 响应指令 (response_instructions)
```json
{
  "response_instructions": {
    "language": "中文",             // 回复语言
    "style": [                      // 语言风格要求
      "学术化",
      "系统化",
      "体系化的隐喻而非信口拈来",
      "避免浮夸和中二",
      "客观公正全面"
    ],
    "must_include": [               // 必须包含的内容
      "系统优势与潜能",
      "系统劣势与风险",
      "不只讲好的，要讲坏的方面",
      "像医生看病，不是夸奖"
    ]
  }
}
```

#### 3. 提示词内容 (prompts)
这是一个对话数组，包含了完整的训练对话：
```json
{
  "prompts": [
    {
      "role": "user",               // 角色：user或model
      "content": "具体内容..."      // 对话内容
    },
    {
      "role": "model",
      "content": "回复内容..."
    }
  ]
}
```

## 如何修改提示词

### 1. 修改分析风格
编辑 `response_instructions.style` 数组，添加或删除风格要求。

### 2. 修改必须包含的内容
编辑 `response_instructions.must_include` 数组，确保分析的全面性。

### 3. 修改案例内容
在 `prompts` 数组中找到对应的user角色内容，修改案例分析。

### 4. 添加新的案例
在 `prompts` 数组中添加新的对话对：
```json
{
  "role": "user",
  "content": "新案例内容..."
},
{
  "role": "model", 
  "content": "AI的理解和回复..."
}
```

### 5. 修改生理学模型
由于生理学模型内容较长，建议：
1. 在`prompts`中找到包含"还有我对八字的一种理解"的user内容
2. 将完整的生理学模型内容粘贴替换

## 重要提醒

1. **保持JSON格式正确**：修改后使用JSON验证工具检查格式
2. **备份原文件**：修改前先备份原始配置
3. **逐步测试**：每次修改后测试是否正常工作
4. **编码格式**：确保文件保存为UTF-8编码

## 测试修改

修改配置后，可以通过以下方式测试：

```bash
cd destiny_clock
python mingli_analysis_api.py 甲子 乙丑 丙寅 丁卯
```

或重启服务后在网页中测试。

## 恢复默认配置

如果配置出现问题，可以：
1. 从备份恢复
2. 重新下载原始配置文件
3. 联系技术支持

## 高级配置

### 调整AI创造性
- `temperature`: 0.1-0.5（保守）、0.5-1.0（平衡）、1.0-2.0（创造性）

### 调整思考深度
- `thinking_budget`: -1（无限制）、1000（快速）、5000（标准）、10000（深度）

### API设置
```json
{
  "api_settings": {
    "timeout": 60,          // 超时时间（秒）
    "max_retries": 3        // 最大重试次数
  }
}
```
